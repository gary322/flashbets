<!DOCTYPE html>
<html>
<head>
    <title>Test Market Search</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; padding: 20px; }
        button { background: #FFD60A; color: #000; border: none; padding: 10px 20px; cursor: pointer; margin: 5px; }
        .log { margin: 10px 0; padding: 10px; background: #111; border-radius: 4px; }
        .error { color: #ff3b30; }
        .success { color: #4cd964; }
        .market { background: #222; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Test Market Search</h1>
    <button onclick="testSearch()">Test Search API</button>
    <button onclick="testPolymarket()">Test Direct Polymarket</button>
    <div id="logs"></div>
    
    <script>
        function log(message, type = '') {
            const div = document.createElement('div');
            div.className = 'log ' + type;
            div.innerHTML = message;
            document.getElementById('logs').appendChild(div);
        }
        
        async function testSearch() {
            log('Testing search API...');
            
            try {
                const response = await fetch('http://localhost:8081/api/polymarket/markets');
                const data = await response.json();
                
                log(`Response status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (data.error) {
                    log(`Error: ${data.error}`, 'error');
                } else if (Array.isArray(data)) {
                    log(`Found ${data.length} markets`, 'success');
                    
                    // Show first 5 markets
                    data.slice(0, 5).forEach(market => {
                        const marketDiv = document.createElement('div');
                        marketDiv.className = 'market';
                        marketDiv.innerHTML = `
                            <strong>${market.title || market.question}</strong><br>
                            ID: ${market.id}<br>
                            Volume: $${(market.volume || 0).toLocaleString()}<br>
                            Status: ${market.active ? 'Active' : 'Inactive'}
                        `;
                        document.getElementById('logs').appendChild(marketDiv);
                    });
                } else {
                    log(`Unexpected response format: ${JSON.stringify(data).substring(0, 200)}...`, 'error');
                }
            } catch (error) {
                log(`Fetch error: ${error.message}`, 'error');
            }
        }
        
        async function testPolymarket() {
            log('Testing direct Polymarket API...');
            
            try {
                const response = await fetch('https://gamma-api.polymarket.com/markets?active=true&closed=false&limit=5');
                const data = await response.json();
                
                log(`Response status: ${response.status}`, response.ok ? 'success' : 'error');
                log(`Response: ${JSON.stringify(data).substring(0, 500)}...`);
            } catch (error) {
                log(`Direct fetch error: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>