<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Betting - Platform Trading Flow</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Helvetica Neue', sans-serif;
            background: #000000;
            color: #FFFFFF;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Demo Stage */
        .demo-stage {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle at center, #0A0A0A 0%, #000000 100%);
        }

        /* Demo Navigation */
        .demo-nav {
            position: fixed;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 20px 40px;
            backdrop-filter: blur(20px);
            z-index: 1000;
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .demo-btn {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            color: #FFFFFF;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 500;
        }

        .demo-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .demo-btn.active {
            background: #FFD60A;
            color: #000000;
            border-color: #FFD60A;
        }

        .play-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #FFD60A;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 20px;
            font-weight: bold;
        }

        .play-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(255, 214, 10, 0.5);
        }

        /* Step Indicator */
        .step-indicator {
            position: fixed;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 40px;
            z-index: 1000;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            opacity: 0.5;
            transition: all 0.3s;
        }

        .step.active {
            opacity: 1;
        }

        .step-number {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 20px;
            transition: all 0.3s;
        }

        .step.active .step-number {
            background: #FFD60A;
            color: #000000;
            border-color: #FFD60A;
            box-shadow: 0 0 20px rgba(255, 214, 10, 0.5);
        }

        .step-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
        }

        /* Main Demo Container */
        .demo-container {
            width: 90%;
            max-width: 1200px;
            margin: 140px auto 100px;
            display: none;
        }

        .demo-container.active {
            display: block;
        }

        /* Market Selection */
        .market-selection {
            display: grid;
            gap: 20px;
            margin-bottom: 40px;
        }

        .market-card {
            padding: 30px;
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .market-card:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateY(-2px);
        }

        .market-card.selected {
            border-color: #FFD60A;
            background: rgba(255, 214, 10, 0.05);
        }

        .market-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .market-title {
            font-size: 24px;
            font-weight: 600;
        }

        .platform-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .platform-badge.polymarket {
            background: linear-gradient(135deg, #4B0AFF 0%, #7B3FF2 100%);
        }

        .platform-badge.kalshi {
            background: linear-gradient(135deg, #00D4FF 0%, #0099CC 100%);
        }

        /* Trading Panel */
        .trading-panel {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .control-section {
            background: rgba(255, 255, 255, 0.03);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #FFD60A;
        }

        /* Base Leverage Slider */
        .leverage-control {
            margin-bottom: 30px;
        }

        .leverage-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .leverage-value {
            font-size: 36px;
            font-weight: 700;
            color: #FFD60A;
        }

        .leverage-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, 
                #4CD964 0%, 
                #FFD60A 20%, 
                #FF9500 60%, 
                #FF3B30 100%);
            border-radius: 4px;
            outline: none;
        }

        .leverage-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #FFFFFF;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        .leverage-marks {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* Order Types */
        .order-types {
            display: grid;
            gap: 10px;
            margin-bottom: 20px;
        }

        .order-type {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .order-type:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .order-type.selected {
            border-color: #FFD60A;
            background: rgba(255, 214, 10, 0.1);
        }

        /* Input Fields */
        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 8px;
            display: block;
        }

        .input-field {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: #FFFFFF;
            font-size: 18px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: #FFD60A;
            background: rgba(255, 255, 255, 0.08);
        }

        /* Flow Visualization */
        .flow-visualization {
            position: relative;
            height: 500px;
            background: rgba(255, 255, 255, 0.02);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            overflow: hidden;
        }

        .your-position {
            position: absolute;
            left: 50%;
            top: 50px;
            transform: translateX(-50%);
            padding: 20px 40px;
            background: rgba(255, 214, 10, 0.1);
            border: 2px solid #FFD60A;
            border-radius: 15px;
            text-align: center;
            z-index: 10;
        }

        .platform-endpoint {
            position: absolute;
            width: 200px;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .platform-endpoint.polymarket {
            left: 100px;
            bottom: 80px;
            background: rgba(75, 10, 255, 0.1);
            border: 2px solid #4B0AFF;
        }

        .platform-endpoint.kalshi {
            right: 100px;
            bottom: 80px;
            background: rgba(0, 212, 255, 0.1);
            border: 2px solid #00D4FF;
        }

        .platform-endpoint:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
        }

        /* Order Flow Animation */
        .order-flow {
            position: absolute;
            width: 160px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            font-size: 12px;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
        }

        @keyframes flowToPolymarket {
            0% {
                left: 50%;
                top: 120px;
                transform: translateX(-50%) scale(0.8);
                opacity: 0;
            }
            20% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            80% {
                opacity: 1;
            }
            100% {
                left: 150px;
                top: 350px;
                transform: translateX(0) scale(0.9);
                opacity: 0;
            }
        }

        @keyframes flowToKalshi {
            0% {
                left: 50%;
                top: 120px;
                transform: translateX(-50%) scale(0.8);
                opacity: 0;
            }
            20% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            80% {
                opacity: 1;
            }
            100% {
                left: calc(100% - 310px);
                top: 350px;
                transform: translateX(0) scale(0.9);
                opacity: 0;
            }
        }

        /* Stop Loss / Take Profit */
        .risk-management {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 59, 48, 0.05);
            border: 2px solid rgba(255, 59, 48, 0.2);
            border-radius: 15px;
        }

        .risk-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        /* Summary */
        .trade-summary {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 214, 10, 0.05);
            border: 2px solid rgba(255, 214, 10, 0.2);
            border-radius: 15px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .summary-label {
            color: rgba(255, 255, 255, 0.6);
        }

        .summary-value {
            font-weight: 600;
            color: #FFD60A;
        }

        /* Execute Button */
        .execute-btn {
            width: 100%;
            padding: 20px;
            background: #FFD60A;
            border: none;
            border-radius: 15px;
            color: #000000;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        .execute-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(255, 214, 10, 0.3);
        }

        .execute-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Verse Display */
        .verse-list {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .verse-item {
            padding: 20px;
            background: rgba(138, 97, 255, 0.05);
            border: 2px solid rgba(138, 97, 255, 0.2);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .verse-item:hover {
            background: rgba(138, 97, 255, 0.1);
            transform: translateX(5px);
        }

        .verse-item.selected {
            border-color: #8A61FF;
            background: rgba(138, 97, 255, 0.15);
        }

        .verse-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .verse-multiplier {
            font-size: 24px;
            font-weight: 700;
            color: #8A61FF;
        }

        /* Platform Indicators */
        .platform-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            text-align: center;
            line-height: 20px;
            font-size: 12px;
            font-weight: 700;
            color: #FFFFFF;
            margin-left: 10px;
        }

        .platform-indicator.polymarket {
            background: #4B0AFF;
        }

        .platform-indicator.kalshi {
            background: #00D4FF;
        }
    </style>
</head>
<body>
    <!-- Step Indicator -->
    <div class="step-indicator">
        <div class="step active" id="step1">
            <div class="step-number">1</div>
            <div class="step-label">Select Market</div>
        </div>
        <div class="step" id="step2">
            <div class="step-number">2</div>
            <div class="step-label">Choose Verses</div>
        </div>
        <div class="step" id="step3">
            <div class="step-number">3</div>
            <div class="step-label">Trade Setup</div>
        </div>
    </div>

    <!-- Demo Stage -->
    <div class="demo-stage">
        <!-- Section 1: Market Selection -->
        <div class="demo-container active" id="section1">
            <h1 style="text-align: center; font-size: 48px; margin-bottom: 40px; background: linear-gradient(135deg, #FFD60A 0%, #FFA500 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                Select Your Market
            </h1>
            
            <div class="market-selection">
                <!-- Polymarket Markets -->
                <div class="market-card" onclick="selectMarket(this, 'btc-150k', 'polymarket')">
                    <div class="market-header">
                        <h3 class="market-title">Will Bitcoin reach $150k in 2025?</h3>
                        <span class="platform-badge polymarket">POLYMARKET</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                        <div style="text-align: center; padding: 15px; background: rgba(76, 217, 100, 0.1); border-radius: 10px;">
                            <div style="color: #4CD964; font-size: 32px; font-weight: 700;">41%</div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6);">YES</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: rgba(255, 59, 48, 0.1); border-radius: 10px;">
                            <div style="color: #FF3B30; font-size: 32px; font-weight: 700;">59%</div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6);">NO</div>
                        </div>
                    </div>
                </div>

                <!-- Kalshi Markets -->
                <div class="market-card" onclick="selectMarket(this, 'fed-cuts', 'kalshi')">
                    <div class="market-header">
                        <h3 class="market-title">Fed cuts rates in March 2025?</h3>
                        <span class="platform-badge kalshi">KALSHI</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                        <div style="text-align: center; padding: 15px; background: rgba(76, 217, 100, 0.1); border-radius: 10px;">
                            <div style="color: #4CD964; font-size: 32px; font-weight: 700;">72%</div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6);">YES</div>
                        </div>
                        <div style="text-align: center; padding: 15px; background: rgba(255, 59, 48, 0.1); border-radius: 10px;">
                            <div style="color: #FF3B30; font-size: 32px; font-weight: 700;">28%</div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6);">NO</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 2: Verse Selection -->
        <div class="demo-container" id="section2">
            <h1 style="text-align: center; font-size: 48px; margin-bottom: 40px; background: linear-gradient(135deg, #8A61FF 0%, #FFD60A 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                Select Your Verses
            </h1>
            <p style="text-align: center; font-size: 20px; color: rgba(255, 255, 255, 0.6); margin-bottom: 40px;">
                Each verse multiplies your leverage and places orders on different platforms
            </p>
            
            <div class="verse-list" id="verseList">
                <!-- Verses will be populated based on selected market -->
            </div>
            
            <div style="text-align: center; margin-top: 40px; padding: 30px; background: rgba(255, 255, 255, 0.03); border-radius: 15px;">
                <div style="font-size: 20px; color: rgba(255, 255, 255, 0.6); margin-bottom: 10px;">Total Leverage</div>
                <div style="font-size: 48px; font-weight: 700; color: #FFD60A;">
                    <span id="totalLeverageDisplay">5</span>x
                </div>
            </div>
        </div>

        <!-- Section 3: Trading Setup -->
        <div class="demo-container" id="section3">
            <h1 style="text-align: center; font-size: 48px; margin-bottom: 40px; background: linear-gradient(135deg, #FFD60A 0%, #FFA500 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                Configure Your Trade
            </h1>
            
            <div class="trading-panel">
                <!-- Left Panel: Controls -->
                <div class="control-section">
                    <h3 class="section-title">Trade Parameters</h3>
                    
                    <!-- Investment Amount -->
                    <div class="input-group">
                        <label class="input-label">Investment Amount</label>
                        <input type="number" class="input-field" id="investmentAmount" value="10000" placeholder="Enter amount">
                    </div>
                    
                    <!-- Base Leverage -->
                    <div class="leverage-control">
                        <div class="leverage-display">
                            <span style="font-size: 16px; color: rgba(255, 255, 255, 0.6);">Base Leverage</span>
                            <span class="leverage-value" id="baseLeverageValue">5x</span>
                        </div>
                        <input type="range" class="leverage-slider" id="baseLeverageSlider" 
                               min="1" max="100" value="5" oninput="updateBaseLeverage(this.value)">
                        <div class="leverage-marks">
                            <span>1x</span>
                            <span>25x</span>
                            <span>50x</span>
                            <span>75x</span>
                            <span>100x</span>
                        </div>
                    </div>
                    
                    <!-- Order Types -->
                    <h4 style="margin: 30px 0 15px; color: #FFD60A;">Order Type</h4>
                    <div class="order-types">
                        <div class="order-type selected" onclick="selectOrderType(this, 'market')">
                            <span>Market Order</span>
                            <span style="color: #4CD964;">‚ö° Instant</span>
                        </div>
                        <div class="order-type" onclick="selectOrderType(this, 'limit')">
                            <span>Limit Order</span>
                            <span style="color: #FFD60A;">üéØ Set Price</span>
                        </div>
                    </div>
                    
                    <!-- Limit Price (hidden by default) -->
                    <div class="input-group" id="limitPriceGroup" style="display: none;">
                        <label class="input-label">Limit Price</label>
                        <input type="number" class="input-field" id="limitPrice" placeholder="0.00">
                    </div>
                    
                    <!-- Risk Management -->
                    <div class="risk-management">
                        <h4 style="margin-bottom: 15px; color: #FF3B30;">Risk Management</h4>
                        <div class="risk-row">
                            <div class="input-group" style="margin: 0;">
                                <label class="input-label">Stop Loss %</label>
                                <input type="number" class="input-field" id="stopLoss" value="10" min="1" max="50">
                            </div>
                            <div class="input-group" style="margin: 0;">
                                <label class="input-label">Take Profit %</label>
                                <input type="number" class="input-field" id="takeProfit" value="50" min="5" max="500">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right Panel: Flow Visualization -->
                <div class="control-section" style="padding: 0; overflow: hidden;">
                    <div class="flow-visualization">
                        <div class="your-position">
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 10px;">Your Position</div>
                            <div style="font-size: 32px; font-weight: 700; color: #FFD60A;">
                                $<span id="positionSize">10,000</span>
                            </div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6); margin-top: 5px;">
                                <span id="orderCount">0</span> orders ready
                            </div>
                        </div>
                        
                        <div class="platform-endpoint polymarket">
                            <div class="platform-badge polymarket" style="margin-bottom: 15px;">POLYMARKET</div>
                            <div style="font-size: 28px; font-weight: 700; color: #7B3FF2; margin-bottom: 10px;">
                                <span id="polymarketOrders">0</span>
                            </div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6);">Orders</div>
                        </div>
                        
                        <div class="platform-endpoint kalshi">
                            <div class="platform-badge kalshi" style="margin-bottom: 15px;">KALSHI</div>
                            <div style="font-size: 28px; font-weight: 700; color: #00D4FF; margin-bottom: 10px;">
                                <span id="kalshiOrders">0</span>
                            </div>
                            <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6);">Orders</div>
                        </div>
                    </div>
                    
                    <!-- Trade Summary -->
                    <div class="trade-summary">
                        <div class="summary-row">
                            <span class="summary-label">Total Leverage:</span>
                            <span class="summary-value" id="summaryLeverage">5x</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Total Exposure:</span>
                            <span class="summary-value" id="summaryExposure">$50,000</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Max Loss:</span>
                            <span class="summary-value" style="color: #FF3B30;" id="summaryMaxLoss">-$1,000</span>
                        </div>
                        <div class="summary-row">
                            <span class="summary-label">Target Profit:</span>
                            <span class="summary-value" style="color: #4CD964;" id="summaryTargetProfit">+$5,000</span>
                        </div>
                    </div>
                    
                    <button class="execute-btn" onclick="executeOrders()">
                        Execute All Orders
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Demo Navigation -->
    <div class="demo-nav">
        <button class="demo-btn" onclick="previousStep()">‚Üê Back</button>
        <button class="play-btn" onclick="playDemo()">‚ñ∂</button>
        <button class="demo-btn" onclick="nextStep()">Next ‚Üí</button>
        <button class="demo-btn" onclick="reset()">Reset</button>
    </div>

    <script>
        // State
        let currentStep = 1;
        let selectedMarket = null;
        let selectedPlatform = null;
        let selectedVerses = [];
        let baseLeverage = 5;
        let orderType = 'market';
        
        // Verse data
        const verseData = {
            'btc-150k': [
                {
                    id: 'etf-inflows',
                    title: 'Bitcoin ETF inflows exceed $50B',
                    multiplier: 1.8,
                    platform: 'polymarket',
                    description: 'Institutional adoption accelerating'
                },
                {
                    id: 'halving-impact',
                    title: 'Post-halving supply shock',
                    multiplier: 1.6,
                    platform: 'polymarket',
                    description: 'Historical 10x multiplier post-halving'
                },
                {
                    id: 'sovereign-adoption',
                    title: 'Major country adopts BTC',
                    multiplier: 2.5,
                    platform: 'kalshi',
                    description: 'Game-changing adoption signal'
                }
            ],
            'fed-cuts': [
                {
                    id: 'inflation-target',
                    title: 'Inflation drops below 2.5%',
                    multiplier: 1.6,
                    platform: 'kalshi',
                    description: 'Primary factor in Fed decisions'
                },
                {
                    id: 'unemployment',
                    title: 'Unemployment rises above 4.5%',
                    multiplier: 1.7,
                    platform: 'kalshi',
                    description: 'Dual mandate consideration'
                },
                {
                    id: 'recession-signal',
                    title: 'Recession indicators flash',
                    multiplier: 2.0,
                    platform: 'polymarket',
                    description: 'Forces emergency Fed action'
                }
            ]
        };
        
        // Navigation
        function updateStepIndicator() {
            document.querySelectorAll('.step').forEach((step, index) => {
                if (index < currentStep) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            
            document.querySelectorAll('.demo-container').forEach(container => {
                container.classList.remove('active');
            });
            document.getElementById(`section${currentStep}`).classList.add('active');
        }
        
        function nextStep() {
            if (currentStep < 3) {
                currentStep++;
                updateStepIndicator();
                
                if (currentStep === 2) {
                    populateVerses();
                } else if (currentStep === 3) {
                    updateTradingDisplay();
                }
            }
        }
        
        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepIndicator();
            }
        }
        
        // Market selection
        function selectMarket(element, marketId, platform) {
            document.querySelectorAll('.market-card').forEach(card => {
                card.classList.remove('selected');
            });
            element.classList.add('selected');
            
            selectedMarket = marketId;
            selectedPlatform = platform;
            
            setTimeout(() => nextStep(), 500);
        }
        
        // Populate verses
        function populateVerses() {
            const verseList = document.getElementById('verseList');
            verseList.innerHTML = '';
            
            const verses = verseData[selectedMarket] || [];
            verses.forEach(verse => {
                const verseItem = document.createElement('div');
                verseItem.className = 'verse-item';
                verseItem.onclick = () => toggleVerse(verseItem, verse);
                
                verseItem.innerHTML = `
                    <div class="verse-header">
                        <div>
                            <h3 style="font-size: 20px; margin-bottom: 5px;">${verse.title}</h3>
                            <p style="color: rgba(255, 255, 255, 0.6); font-size: 14px;">${verse.description}</p>
                        </div>
                        <div style="text-align: right;">
                            <div class="verse-multiplier">√ó${verse.multiplier}</div>
                            <span class="platform-indicator ${verse.platform}">${verse.platform === 'polymarket' ? 'P' : 'K'}</span>
                        </div>
                    </div>
                `;
                
                verseList.appendChild(verseItem);
            });
        }
        
        // Toggle verse selection
        function toggleVerse(element, verse) {
            element.classList.toggle('selected');
            
            if (element.classList.contains('selected')) {
                selectedVerses.push(verse);
            } else {
                selectedVerses = selectedVerses.filter(v => v.id !== verse.id);
            }
            
            updateTotalLeverage();
        }
        
        // Update total leverage
        function updateTotalLeverage() {
            let totalMultiplier = baseLeverage;
            selectedVerses.forEach(verse => {
                totalMultiplier *= verse.multiplier;
            });
            
            document.getElementById('totalLeverageDisplay').textContent = totalMultiplier.toFixed(1);
            document.getElementById('summaryLeverage').textContent = totalMultiplier.toFixed(1) + 'x';
            
            updateTradingDisplay();
        }
        
        // Update base leverage
        function updateBaseLeverage(value) {
            baseLeverage = parseInt(value);
            document.getElementById('baseLeverageValue').textContent = baseLeverage + 'x';
            updateTotalLeverage();
        }
        
        // Select order type
        function selectOrderType(element, type) {
            document.querySelectorAll('.order-type').forEach(el => {
                el.classList.remove('selected');
            });
            element.classList.add('selected');
            
            orderType = type;
            document.getElementById('limitPriceGroup').style.display = 
                type === 'limit' ? 'block' : 'none';
        }
        
        // Update trading display
        function updateTradingDisplay() {
            const investment = parseFloat(document.getElementById('investmentAmount').value) || 0;
            
            // Count orders by platform
            let polymarketCount = 0;
            let kalshiCount = 0;
            
            if (selectedPlatform === 'polymarket') polymarketCount++;
            else if (selectedPlatform === 'kalshi') kalshiCount++;
            
            selectedVerses.forEach(verse => {
                if (verse.platform === 'polymarket') polymarketCount++;
                else if (verse.platform === 'kalshi') kalshiCount++;
            });
            
            // Update displays
            document.getElementById('positionSize').textContent = investment.toLocaleString();
            document.getElementById('orderCount').textContent = polymarketCount + kalshiCount;
            document.getElementById('polymarketOrders').textContent = polymarketCount;
            document.getElementById('kalshiOrders').textContent = kalshiCount;
            
            // Calculate totals
            let totalLeverage = baseLeverage;
            selectedVerses.forEach(verse => {
                totalLeverage *= verse.multiplier;
            });
            
            const exposure = investment * totalLeverage;
            const stopLoss = parseFloat(document.getElementById('stopLoss').value) || 10;
            const takeProfit = parseFloat(document.getElementById('takeProfit').value) || 50;
            const maxLoss = investment * (stopLoss / 100);
            const targetProfit = investment * (takeProfit / 100);
            
            // Update summary
            document.getElementById('summaryExposure').textContent = '$' + exposure.toLocaleString();
            document.getElementById('summaryMaxLoss').textContent = '-$' + maxLoss.toLocaleString();
            document.getElementById('summaryTargetProfit').textContent = '+$' + targetProfit.toLocaleString();
        }
        
        // Execute orders with animation
        function executeOrders() {
            const flowViz = document.querySelector('.flow-visualization');
            
            // Create order for main market
            createOrderFlow(selectedMarket, selectedPlatform);
            
            // Create orders for verses
            selectedVerses.forEach((verse, index) => {
                setTimeout(() => {
                    createOrderFlow(verse.title, verse.platform);
                }, (index + 1) * 800);
            });
        }
        
        // Create animated order flow
        function createOrderFlow(market, platform) {
            const order = document.createElement('div');
            order.className = 'order-flow';
            order.innerHTML = `
                <div style="font-weight: 600; margin-bottom: 5px;">${orderType.toUpperCase()} ORDER</div>
                <div style="font-size: 11px; color: rgba(255, 255, 255, 0.8);">${market}</div>
                <div style="margin-top: 8px; display: flex; justify-content: space-between; font-size: 10px;">
                    <span>Leverage: ${baseLeverage}x</span>
                    <span>SL: ${document.getElementById('stopLoss').value}%</span>
                </div>
            `;
            
            document.querySelector('.flow-visualization').appendChild(order);
            
            // Apply animation based on platform
            order.style.animation = platform === 'polymarket' ? 
                'flowToPolymarket 2s ease-out forwards' : 
                'flowToKalshi 2s ease-out forwards';
            
            // Remove after animation
            setTimeout(() => order.remove(), 2000);
        }
        
        // Play demo
        function playDemo() {
            reset();
            setTimeout(() => document.querySelectorAll('.market-card')[0].click(), 500);
            setTimeout(() => {
                document.querySelectorAll('.verse-item').forEach((item, i) => {
                    if (i < 2) setTimeout(() => item.click(), 2000 + i * 300);
                });
            }, 1500);
            setTimeout(() => nextStep(), 3000);
            setTimeout(() => executeOrders(), 4000);
        }
        
        // Reset
        function reset() {
            currentStep = 1;
            selectedMarket = null;
            selectedPlatform = null;
            selectedVerses = [];
            baseLeverage = 5;
            orderType = 'market';
            
            document.getElementById('baseLeverageSlider').value = 5;
            updateBaseLeverage(5);
            document.querySelectorAll('.selected').forEach(el => el.classList.remove('selected'));
            document.querySelectorAll('.order-type')[0].click();
            
            updateStepIndicator();
        }
        
        // Initialize
        document.getElementById('investmentAmount').addEventListener('input', updateTradingDisplay);
        document.getElementById('stopLoss').addEventListener('input', updateTradingDisplay);
        document.getElementById('takeProfit').addEventListener('input', updateTradingDisplay);
    </script>
</body>
</html>