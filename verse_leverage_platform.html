<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verse-Leverage Betting Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            color: #fff;
            overflow-x: hidden;
        }

        .header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            z-index: 1000;
            padding: 20px 40px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(45deg, #0066ff, #00ffcc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .search-container {
            margin: 100px 40px 40px;
        }

        .search-box {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }

        .search-input {
            width: 100%;
            padding: 20px 60px 20px 20px;
            font-size: 18px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            color: #fff;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.08);
            border-color: #0066ff;
        }

        .search-button {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: #0066ff;
            border: none;
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-button:hover {
            background: #0052cc;
        }

        .main-container {
            display: grid;
            grid-template-columns: 300px 1fr 300px;
            gap: 20px;
            margin: 0 40px;
            height: calc(100vh - 200px);
        }

        .verse-panel {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            overflow-y: auto;
        }

        .panel-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #0066ff;
        }

        .verse-tree {
            position: relative;
        }

        .verse-node {
            margin: 10px 0;
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .verse-node:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: #0066ff;
        }

        .verse-node.selected {
            background: rgba(0, 102, 255, 0.2);
            border-color: #0066ff;
        }

        .verse-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            position: relative;
            transition: all 0.3s;
        }

        .verse-checkbox.checked {
            background: #0066ff;
            border-color: #0066ff;
        }

        .verse-checkbox.checked::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 14px;
        }

        .verse-name {
            flex: 1;
        }

        .verse-leverage {
            font-size: 12px;
            color: #00ffcc;
            font-weight: 600;
        }

        .market-view {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .market-header {
            text-align: center;
        }

        .market-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .market-status {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }

        .status-item {
            text-align: center;
        }

        .status-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            text-transform: uppercase;
        }

        .status-value {
            font-size: 24px;
            font-weight: 600;
            margin-top: 5px;
        }

        .leverage-display {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
        }

        .leverage-meter {
            width: 200px;
            height: 200px;
            margin: 20px auto;
            position: relative;
        }

        .leverage-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 10px solid rgba(255, 255, 255, 0.1);
            position: relative;
            transform: rotate(-90deg);
        }

        .leverage-fill {
            position: absolute;
            top: -5px;
            left: -5px;
            width: 210px;
            height: 210px;
            border-radius: 50%;
            border: 10px solid transparent;
            border-top-color: #0066ff;
            border-right-color: #0066ff;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .leverage-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: 600;
            color: #0066ff;
        }

        .leverage-label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 20px;
        }

        .leverage-panel {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
        }

        .leverage-breakdown {
            margin-top: 20px;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .breakdown-label {
            color: rgba(255, 255, 255, 0.6);
        }

        .breakdown-value {
            font-weight: 600;
            color: #00ffcc;
        }

        .auto-verse-indicator {
            background: rgba(0, 255, 204, 0.1);
            border: 1px solid #00ffcc;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        .trading-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        .trade-button {
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .buy-button {
            background: #00c851;
            color: #fff;
        }

        .buy-button:hover {
            background: #00a642;
        }

        .sell-button {
            background: #ff3547;
            color: #fff;
        }

        .sell-button:hover {
            background: #cc0000;
        }

        .position-size {
            grid-column: 1 / -1;
            margin-bottom: 10px;
        }

        .position-input {
            width: 100%;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            text-align: center;
        }

        .outcome-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .outcome-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .outcome-card:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: #0066ff;
        }

        .outcome-card.selected {
            background: rgba(0, 102, 255, 0.2);
            border-color: #0066ff;
        }

        .loading-animation {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1000;
        }

        .loading-animation.active {
            display: block;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #0066ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .tooltip.active {
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="header">
        <nav class="nav">
            <div class="logo">Verse-Leverage Platform</div>
            <div class="account-info">
                <span style="margin-right: 20px;">Balance: $10,000</span>
                <span style="color: #00ffcc;">MMT: 1,250</span>
            </div>
        </nav>
    </div>

    <div class="search-container">
        <div class="search-box">
            <input type="text" class="search-input" placeholder="Search for any market or event..." id="marketSearch">
            <button class="search-button" onclick="searchMarket()">→</button>
        </div>
    </div>

    <div class="main-container">
        <div class="verse-panel">
            <h3 class="panel-title">Verse Hierarchy</h3>
            <div class="auto-verse-indicator" id="autoVerseIndicator" style="display: none;">
                Auto-generating verses...
            </div>
            <div class="verse-tree" id="verseTree">
                <div class="verse-node" style="color: rgba(255,255,255,0.5); text-align: center;">
                    Search for a market to see verses
                </div>
            </div>
        </div>

        <div class="market-view">
            <div class="market-header">
                <h2 class="market-title" id="marketTitle">Search for a Market</h2>
                <div class="market-status">
                    <div class="status-item">
                        <div class="status-label">Volume</div>
                        <div class="status-value" id="volumeDisplay">$0</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Liquidity</div>
                        <div class="status-value" id="liquidityDisplay">$0</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Participants</div>
                        <div class="status-value" id="participantsDisplay">0</div>
                    </div>
                </div>
            </div>

            <div class="leverage-display">
                <h3>Effective Leverage</h3>
                <div class="leverage-meter">
                    <div class="leverage-circle">
                        <div class="leverage-fill" id="leverageFill"></div>
                    </div>
                    <div class="leverage-value" id="leverageValue">1x</div>
                </div>
                <div class="leverage-label">Based on selected verses</div>
            </div>

            <div class="outcome-grid" id="outcomeGrid">
                <!-- Outcomes will be populated here -->
            </div>

            <div class="trading-controls">
                <div class="position-size">
                    <input type="number" class="position-input" id="positionSize" placeholder="Position Size ($)" value="1000">
                </div>
                <button class="trade-button buy-button" onclick="executeTrade('buy')">BUY</button>
                <button class="trade-button sell-button" onclick="executeTrade('sell')">SELL</button>
            </div>
        </div>

        <div class="leverage-panel">
            <h3 class="panel-title">Leverage Breakdown</h3>
            <div class="leverage-breakdown" id="leverageBreakdown">
                <div class="breakdown-item">
                    <span class="breakdown-label">Base Leverage</span>
                    <span class="breakdown-value">1x</span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">Verse Multipliers</span>
                    <span class="breakdown-value" id="verseMultiplier">0x</span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">Total Selected</span>
                    <span class="breakdown-value" id="totalSelected">0 verses</span>
                </div>
                <div class="breakdown-item">
                    <span class="breakdown-label">Max Potential</span>
                    <span class="breakdown-value" id="maxPotential">100x</span>
                </div>
            </div>

            <div style="margin-top: 30px;">
                <h4 style="margin-bottom: 15px; color: #0066ff;">Selected Verses Impact</h4>
                <div id="selectedVersesList" style="color: rgba(255,255,255,0.6); text-align: center;">
                    No verses selected
                </div>
            </div>
        </div>
    </div>

    <div class="loading-animation" id="loadingAnimation">
        <div class="loading-spinner"></div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // Verse data structure
        let verses = [];
        let selectedVerses = new Set();
        let currentMarket = null;
        let effectiveLeverage = 1;

        // Verse leverage multipliers by level
        const verseLeverageMap = {
            1: 2,    // Top level: 2x
            2: 1.8,  // Second level: 1.8x
            3: 1.6,  // Third level: 1.6x
            4: 1.4,  // Fourth level: 1.4x
            5: 1.2,  // Fifth level: 1.2x
            6: 1.1,  // Sixth level: 1.1x
            default: 1.05  // Lower levels: 1.05x
        };

        // Generate verse hierarchy from search term
        function generateVersesFromSearch(searchTerm) {
            verses = [];
            const words = searchTerm.split(' ');
            
            // Create main verse
            const mainVerse = {
                id: 'verse-1',
                name: searchTerm,
                level: 1,
                leverage: verseLeverageMap[1],
                children: []
            };
            verses.push(mainVerse);

            // Generate sub-verses based on categories
            const categories = detectCategories(searchTerm);
            categories.forEach((category, idx) => {
                const subVerse = {
                    id: `verse-2-${idx}`,
                    name: category,
                    level: 2,
                    leverage: verseLeverageMap[2],
                    parent: mainVerse.id,
                    children: []
                };
                verses.push(subVerse);
                mainVerse.children.push(subVerse.id);

                // Generate deeper verses
                generateDeepVerses(subVerse, 3, 5);
            });

            return verses;
        }

        // Detect categories from search term
        function detectCategories(searchTerm) {
            const term = searchTerm.toLowerCase();
            const categories = [];

            // Sports
            if (term.includes('game') || term.includes('match') || term.includes('vs')) {
                categories.push('Live Odds', 'Player Props', 'Team Stats', 'Historical Performance');
            }
            // Politics
            else if (term.includes('election') || term.includes('president') || term.includes('vote')) {
                categories.push('Polling Data', 'State Results', 'Demographics', 'Historical Trends');
            }
            // Finance
            else if (term.includes('stock') || term.includes('crypto') || term.includes('$')) {
                categories.push('Price Action', 'Volume Analysis', 'Technical Indicators', 'Market Sentiment');
            }
            // Entertainment
            else if (term.includes('award') || term.includes('movie') || term.includes('show')) {
                categories.push('Critic Reviews', 'Audience Score', 'Box Office', 'Social Buzz');
            }
            // Default
            else {
                categories.push('Outcome Analysis', 'Market Dynamics', 'Risk Factors', 'Probability Curves');
            }

            return categories;
        }

        // Generate deeper verse levels
        function generateDeepVerses(parentVerse, currentLevel, maxLevel) {
            if (currentLevel > maxLevel) return;

            const subCategories = {
                'Live Odds': ['Moneyline', 'Spread', 'Over/Under'],
                'Player Props': ['Points', 'Assists', 'Rebounds'],
                'Team Stats': ['Offense Rating', 'Defense Rating', 'Recent Form'],
                'Historical Performance': ['H2H Record', 'Home/Away', 'Season Trends'],
                'Polling Data': ['National Polls', 'Swing States', 'Likely Voters'],
                'State Results': ['Urban Areas', 'Rural Areas', 'Suburbs'],
                'Demographics': ['Age Groups', 'Education', 'Income'],
                'Historical Trends': ['Past Elections', 'Incumbency', 'Party Performance'],
                'Price Action': ['Support Levels', 'Resistance', 'Moving Averages'],
                'Volume Analysis': ['Buy/Sell Ratio', 'Large Orders', 'Accumulation'],
                'Technical Indicators': ['RSI', 'MACD', 'Bollinger Bands'],
                'Market Sentiment': ['Fear/Greed', 'Social Volume', 'News Sentiment']
            };

            const subItems = subCategories[parentVerse.name] || ['Factor A', 'Factor B', 'Factor C'];
            
            subItems.forEach((item, idx) => {
                const subVerse = {
                    id: `verse-${currentLevel}-${parentVerse.id}-${idx}`,
                    name: item,
                    level: currentLevel,
                    leverage: verseLeverageMap[currentLevel] || verseLeverageMap.default,
                    parent: parentVerse.id,
                    children: []
                };
                verses.push(subVerse);
                parentVerse.children.push(subVerse.id);

                // Recursively generate more levels
                if (Math.random() > 0.5) {
                    generateDeepVerses(subVerse, currentLevel + 1, maxLevel);
                }
            });
        }

        // Search for market
        async function searchMarket() {
            const searchInput = document.getElementById('marketSearch');
            const searchTerm = searchInput.value.trim();
            
            if (!searchTerm) return;

            // Show loading
            document.getElementById('loadingAnimation').classList.add('active');
            document.getElementById('autoVerseIndicator').style.display = 'block';

            // Simulate API call
            await new Promise(resolve => setTimeout(resolve, 1500));

            // Generate verses
            verses = generateVersesFromSearch(searchTerm);
            currentMarket = {
                title: searchTerm,
                volume: Math.floor(Math.random() * 1000000) + 100000,
                liquidity: Math.floor(Math.random() * 5000000) + 500000,
                participants: Math.floor(Math.random() * 10000) + 1000,
                outcomes: generateOutcomes(searchTerm)
            };

            // Update UI
            updateMarketDisplay();
            renderVerseTree();
            
            // Auto-select some verses
            autoSelectVerses();

            // Hide loading
            document.getElementById('loadingAnimation').classList.remove('active');
            document.getElementById('autoVerseIndicator').style.display = 'none';
        }

        // Generate outcomes based on market type
        function generateOutcomes(searchTerm) {
            const term = searchTerm.toLowerCase();
            
            if (term.includes('vs') || term.includes('game')) {
                return ['Team A Wins', 'Team B Wins'];
            } else if (term.includes('election')) {
                return ['Candidate A', 'Candidate B', 'Other'];
            } else if (term.includes('price') || term.includes('$')) {
                return ['Above Target', 'Below Target'];
            } else {
                return ['Yes', 'No'];
            }
        }

        // Auto-select relevant verses
        function autoSelectVerses() {
            selectedVerses.clear();
            
            // Select top-level verse and some children
            verses.forEach(verse => {
                if (verse.level <= 2 || (verse.level === 3 && Math.random() > 0.5)) {
                    selectedVerses.add(verse.id);
                }
            });

            updateLeverageCalculation();
        }

        // Render verse tree
        function renderVerseTree() {
            const verseTree = document.getElementById('verseTree');
            verseTree.innerHTML = '';

            // Group verses by level
            const versesByLevel = {};
            verses.forEach(verse => {
                if (!versesByLevel[verse.level]) {
                    versesByLevel[verse.level] = [];
                }
                versesByLevel[verse.level].push(verse);
            });

            // Render each level
            Object.keys(versesByLevel).sort((a, b) => a - b).forEach(level => {
                versesByLevel[level].forEach(verse => {
                    const node = createVerseNode(verse);
                    verseTree.appendChild(node);
                });
            });
        }

        // Create verse node element
        function createVerseNode(verse) {
            const node = document.createElement('div');
            node.className = 'verse-node';
            if (selectedVerses.has(verse.id)) {
                node.classList.add('selected');
            }
            node.style.marginLeft = `${(verse.level - 1) * 20}px`;

            const checkbox = document.createElement('div');
            checkbox.className = 'verse-checkbox';
            if (selectedVerses.has(verse.id)) {
                checkbox.classList.add('checked');
            }

            const name = document.createElement('div');
            name.className = 'verse-name';
            name.textContent = verse.name;

            const leverage = document.createElement('div');
            leverage.className = 'verse-leverage';
            leverage.textContent = `${verse.leverage}x`;

            node.appendChild(checkbox);
            node.appendChild(name);
            node.appendChild(leverage);

            node.onclick = () => toggleVerse(verse.id);

            return node;
        }

        // Toggle verse selection
        function toggleVerse(verseId) {
            if (selectedVerses.has(verseId)) {
                selectedVerses.delete(verseId);
            } else {
                selectedVerses.add(verseId);
            }

            renderVerseTree();
            updateLeverageCalculation();
        }

        // Calculate effective leverage
        function updateLeverageCalculation() {
            let totalLeverage = 1;
            const selectedVersesList = [];

            selectedVerses.forEach(verseId => {
                const verse = verses.find(v => v.id === verseId);
                if (verse) {
                    totalLeverage *= verse.leverage;
                    selectedVersesList.push({
                        name: verse.name,
                        leverage: verse.leverage
                    });
                }
            });

            // Cap at 100x
            effectiveLeverage = Math.min(totalLeverage, 100);

            // Update displays
            document.getElementById('leverageValue').textContent = `${effectiveLeverage.toFixed(1)}x`;
            document.getElementById('verseMultiplier').textContent = `${(effectiveLeverage - 1).toFixed(1)}x`;
            document.getElementById('totalSelected').textContent = `${selectedVerses.size} verses`;

            // Update leverage meter
            const rotation = (effectiveLeverage / 100) * 180;
            document.getElementById('leverageFill').style.transform = `rotate(${rotation}deg)`;

            // Update selected verses list
            const listContainer = document.getElementById('selectedVersesList');
            if (selectedVersesList.length > 0) {
                listContainer.innerHTML = selectedVersesList
                    .map(v => `<div style="margin: 5px 0;">${v.name} (+${(v.leverage - 1).toFixed(1)}x)</div>`)
                    .join('');
            } else {
                listContainer.innerHTML = 'No verses selected';
            }
        }

        // Update market display
        function updateMarketDisplay() {
            document.getElementById('marketTitle').textContent = currentMarket.title;
            document.getElementById('volumeDisplay').textContent = `$${currentMarket.volume.toLocaleString()}`;
            document.getElementById('liquidityDisplay').textContent = `$${currentMarket.liquidity.toLocaleString()}`;
            document.getElementById('participantsDisplay').textContent = currentMarket.participants.toLocaleString();

            // Render outcomes
            const outcomeGrid = document.getElementById('outcomeGrid');
            outcomeGrid.innerHTML = '';
            currentMarket.outcomes.forEach(outcome => {
                const card = document.createElement('div');
                card.className = 'outcome-card';
                card.innerHTML = `
                    <div style="font-size: 18px; font-weight: 600;">${outcome}</div>
                    <div style="margin-top: 10px; color: #00ffcc;">${(100 / currentMarket.outcomes.length).toFixed(1)}%</div>
                `;
                outcomeGrid.appendChild(card);
            });
        }

        // Execute trade
        function executeTrade(side) {
            const positionSize = parseFloat(document.getElementById('positionSize').value) || 0;
            if (positionSize <= 0) {
                alert('Please enter a valid position size');
                return;
            }

            const effectivePosition = positionSize * effectiveLeverage;
            alert(`${side.toUpperCase()} Order Placed!\n\nPosition: $${positionSize.toLocaleString()}\nLeverage: ${effectiveLeverage.toFixed(1)}x\nEffective Exposure: $${effectivePosition.toLocaleString()}\n\nSelected Verses: ${selectedVerses.size}`);
        }

        // Initialize with example
        document.addEventListener('DOMContentLoaded', () => {
            // Set example search
            document.getElementById('marketSearch').value = 'Lakers vs Celtics NBA Finals Game 7';
        });
    </script>
</body>
</html>